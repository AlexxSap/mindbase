источник https://go.dev/ref/mod

Модуль представляет собой набор пакетов, которые выпускаются, версионируются и распространяются вместе. Модули можно загружать непосредственно из репозиториев системы контроля версий или с прокси-серверов модуля.

Модуль идентифицируется по [пути к модулю](https://go.dev/ref/mod#glos-module-path), который объявляется в [`go.mod` файле](https://go.dev/ref/mod#go-mod-file) вместе с информацией о зависимостях модуля. Корневой каталог модуля - это каталог, содержащий `go.mod` файл. Основной модуль - это модуль, содержащий каталог, в котором вызывается `go` команда.

## `go.mod` Файлы

Модуль определяется текстовым файлом в кодировке UTF-8 с именем `go.mod` в его корневом каталоге. `go.mod` Файл ориентирован на строку. Каждая строка содержит единственную директиву, состоящую из ключевого слова, за которым следуют аргументы.

### файлы go.sum

В корневом каталоге модуля может быть текстовый файл с именем `go.sum` рядом с его `go.mod` файлом. `go.sum` Файл содержит криптографические хэши прямых и косвенных зависимостей модуля. Когда `go` команда загружает модуль `.mod` или `.zip` файл в [кэш модуля](https://go.dev/ref/mod#module-cache), она вычисляет хэш и проверяет, совпадает ли хэш с соответствующим хэшем в `go.sum` файле основного модуля. `go.sum` может быть пустым или отсутствовать, если модуль не имеет зависимостей или если все зависимости заменены локальными каталогами с использованием [`replace` директив](https://go.dev/ref/mod#go-mod-file-replace).

### `module` директива

`module`Директива определяет [путь](https://go.dev/ref/mod#glos-module-path) к основному модулю. `go.mod` Файл должен содержать ровно одну `module` директиву.

#### Устаревание

Модуль может быть помечен как устаревший в блоке комментариев, содержащих строку `Deprecated:` (с учетом регистра) в начале абзаца. Сообщение об устаревании начинается после двоеточия и продолжается до конца абзаца. Комментарии могут появляться непосредственно перед директивой `module` или после нее в той же строке.

Пример:
```
// Deprecated: use example.com/mod/v2 instead.
module example.com/mod
```

### `go` директива

Директива `go` указывает, что модуль был написан с учетом семантики данной версии Go. Версия должна соответствовать действительной [версии Go](https://go.dev/doc/toolchain#version), такой как `1.9`, `1.14` или `1.21rc1`.

Директива `go` устанавливает минимальную версию Go, необходимую для использования этого модуля. До Go 1.21 директива носила исключительно рекомендательный характер; теперь это обязательное требование: цепочки инструментов Go отказываются использовать модули, объявляющие более новые версии Go.

`go` Директива является исходным элементом для выбора набора инструментов Go для запуска.

### `require` директива

В `require` директиве объявляется минимально необходимая версия зависимости данного модуля. Для каждой требуемой версии модуля `go` команда загружает `go.mod` файл для этой версии и включает требования из этого файла. Как только все требования загружены, `go` команда разрешает их.

### `exclude` директива

`exclude` Директива предотвращает загрузку версии модуля командой `go`. `exclude` директивы применяются только в `go.mod` файле основного модуля и игнорируются в других модулях.

Пример:
```
exclude golang.org/x/net v1.2.3

exclude (
    golang.org/x/crypto v1.4.5
    golang.org/x/text v1.6.7
)
```

### `replace` директива

Директива `replace` заменяет содержимое определенной версии модуля или всех версий модуля содержимым, найденным в другом месте. Для замены может быть указан либо другой путь к модулю и версия, либо путь к файлу, зависящий от платформы.

### Команды сборки

Все команды, которые загружают информацию о пакетах, зависят от модуля. Сюда входят:

- `go build`
- `go fix`
- `go generate`
- `go install`
- `go list`
- `go run`
- `go test`
- `go vet`

При запуске в режиме с поддержкой модуля эти команды используют `go.mod` файлы для интерпретации путей импорта, перечисленных в командной строке или записанных в исходных файлах Go. Эти команды принимают следующие флаги, общие для всех команд модуля.

- Флаг `-mod` определяет, может ли `go.mod` обновляться автоматически и используется ли `vendor` каталог.
    - `-mod=mod` указывает `go` команде игнорировать каталог поставщиков и [автоматически обновлять](https://go.dev/ref/mod#go-mod-file-updates) `go.mod`, например, когда импортированный пакет не предоставляется ни одним известным модулем.
    - `-mod=readonly` указывает `go` команде игнорировать `vendor` каталог и сообщать об ошибке, если `go.mod` необходимо обновить.
    - `-mod=vendor` указывает `go` команде использовать `vendor` каталог. В этом режиме `go` команда не будет использовать сеть или кэш модуля.
    - По умолчанию, если [`go` версия](https://go.dev/ref/mod#go-mod-file-go) в `go.mod` является `1.14` или выше и `vendor` каталог присутствует, `go` команда действует так, как если бы `-mod=vendor` использовалась. В противном случае `go` команда действует так, как если бы `-mod=readonly` использовалась.
    - `go get` отклоняет этот флаг, поскольку целью команды является изменение зависимостей, что разрешено только `-mod=mod`.
- Флаг `-modcacherw` указывает `go` команде создавать новые каталоги в кэше модуля с разрешениями на чтение и запись вместо того, чтобы делать их доступными только для чтения. При постоянном использовании этого флага (обычно путем установки `GOFLAGS=-modcacherw` в среде или запуска `go env -w GOFLAGS=-modcacherw`) кэш модуля может быть удален командами типа `rm -r` без предварительного изменения разрешений. Команда [`go clean -modcache`](https://go.dev/ref/mod#go-clean-modcache) может использоваться для удаления кэша модуля, независимо от того, использовалась она или нет `-modcacherw`.
- `-modfile=file.mod` Флаг указывает `go` команде прочитать (и, возможно, записать) альтернативный файл вместо `go.mod` в корневом каталоге модуля. Имя файла должно заканчиваться на `.mod`. Файл с именем `go.mod` все еще должен присутствовать, чтобы определить корневой каталог модуля, но к нему нет доступа. Когда `-modfile` указан, также используется альтернативный `go.sum` файл: его путь выводится из `-modfile` флага путем обрезки `.mod` расширения и добавления `.sum`.

### `go get`

Использование:
```
go get [-d] [-t] [-u] [build flags] [packages]
```

Команда `go get` обновляет зависимости модуля в [`go.mod` файле](https://go.dev/ref/mod#go-mod-file) для [основного модуля](https://go.dev/ref/mod#glos-main-module), затем выполняет сборку и устанавливает пакеты, перечисленные в командной строке.

`go get` поддерживает следующие флаги:

- `-d` Флаг указывает `go get` не создавать и не устанавливать пакеты. Когда `-d` используется, `go get` будет управлять зависимостями только в `go.mod`. Использование `go get` without `-d` для сборки и установки пакетов устарело (начиная с версии Go 1.17). В Go 1.18 `-d` всегда будет включено.
- `-u` Флаг указывает `go get` обновить модули, обеспечивающие пакеты, импортированные прямо или косвенно пакетами, названными в командной строке. Каждый модуль, выбранный `-u`, будет обновлен до последней версии, если только он уже не требуется в более поздней версии (предварительном выпуске).
- `-u=patch` Флаг (не `-u patch`) также указывает `go get` на обновление зависимостей, но `go get` обновит каждую зависимость до последней версии исправления (аналогично `@patch` запросу версии).
- `-t` Флаг указывает `go get` учитывать модули, необходимые для построения тестов пакетов, названных в командной строке. Когда `-t` и `-u` используются вместе, `go get` также будут обновлены тестовые зависимости.
- Флаг `-insecure` больше не следует использовать. Он позволяет `go get` разрешать пользовательские пути импорта и извлекать данные из репозиториев и прокси-серверов модулей, используя небезопасные схемы, такие как HTTP. `GOINSECURE` [Переменная окружения](https://go.dev/ref/mod#environment-variables) обеспечивает более детальный контроль и должна использоваться вместо нее.

### `go install`

Использование:
```
go install [build flags] [packages]
```

Команда `go install` создает и устанавливает пакеты, названные по путям в командной строке.

### `go list -m`

Использование:
```
go list -m [-u] [-retracted] [-versions] [list flags] [modules]
```

`-m` Флаг вызывает `go list` отображение модулей вместо пакетов. В этом режиме аргументами для `go list` могут быть модули, шаблоны модулей (содержащие подстановочный знак `...`), [запросы версий](https://go.dev/ref/mod#version-queries) или специальный шаблон `all`, который соответствует всем модулям в [списке сборки](https://go.dev/ref/mod#glos-build-list). Если аргументы не указаны , отображается [основной модуль](https://go.dev/ref/mod#glos-main-module).

### `go mod download`

Использование:
```
go mod download [-x] [-json] [-reuse=old.json] [modules]
```

Команда `go mod download` загружает названные модули в [кэш модулей](https://go.dev/ref/mod#glos-module-cache). Аргументами могут быть пути к модулю или module шаблоны, выбирающие зависимости основного модуля или [запросы версий](https://go.dev/ref/mod#version-queries) формы `path@version`. Без аргументов, `download` применяется ко всем зависимостям [основного модуля](https://go.dev/ref/mod#glos-main-module).
`-json` Флаг вызывает `download` вывод последовательности объектов JSON в стандартный вывод, описывающий каждый загруженный модуль (или сбой)
`-x` Флаг вызывает `download` вывод команд, `download` выполняемых на печать стандартная ошибка.
Флаг -reuse принимает имя файла, содержащего выходные данные JSON предыдущего вызова ‘go mod download -json’. Команда go может использовать этот файл, чтобы определить, что модуль не изменился с момента предыдущего вызова, и избежать его повторной загрузки.

### `go mod edit`

Использование:
```
go mod edit [editing flags] [-fmt|-print|-json] [go.mod]
```

Команда `go mod edit` предоставляет интерфейс командной строки для редактирования и форматирования `go.mod` файлов, предназначенный в основном для использования инструментами и скриптами. `go mod edit` считывает только один `go.mod` файл; информация о других модулях не просматривается . По умолчанию `go mod edit` считывает и записывает `go.mod` файл основного модуля, но после редактирования может быть указан другой целевой файл флаги.

### `go mod graph`

Использование:
```
go mod graph [-go=version]
```

Команда `go mod graph` выводит [график требований к модулю](https://go.dev/ref/mod#glos-module-graph) (с применяемыми заменами) в текстовой форме.

### `go mod init`

Использование:
```
go mod init [module-path]
```

Команда `go mod init` инициализирует и записывает новый `go.mod` файл в текущий каталог, фактически создавая новый модуль с корнем в текущем каталоге . `go.mod` Файл, должно быть, еще не существует.

### `go mod tidy`

Использование:
```
go mod tidy [-e] [-v] [-go=version] [-compat=version]
```

`go mod tidy` гарантирует, что `go.mod` файл соответствует исходному коду в модуле . Он добавляет все недостающие требования к модулю, необходимые для сборки текущего пакетов и зависимостей модуля, и удаляет требования к модулям, которые не предоставляют никаких соответствующих пакетов. Он также добавляет все недостающие записи в `go.sum` и удаляет ненужные записи.

### `go mod vendor`

Использование:
```
go mod vendor [-e] [-v] [-o]
```

Команда `go mod vendor` создает каталог с именем `vendor` в [корневом каталоге](https://go.dev/ref/mod#glos-main-module) главного модуля, который содержит копии всех пакетов необходим для поддержки сборок и тестов пакетов в главном модуле. Пакеты , которые импортируются только с помощью тестов пакетов вне основного модуля, не включены . Как и в случае с [`go mod tidy`](https://go.dev/ref/mod#go-mod-tidy) и другими командами модуля, [ограничения сборки,](https://go.dev/ref/mod#glos-build-constraint) за исключением `ignore`, не учитываются при создании `vendor` каталога.
Когда включена поддержка поставщиков, `go` команда будет загружать пакеты из `vendor` каталога вместо загрузки модулей из их исходных текстов в кэш модуля и использования пакетов, которые являются загруженными копиями.

### `go mod verify`

Использование:
```
go mod verify
```

`go mod verify` проверяет наличие зависимостей [основной модуль](https://go.dev/ref/mod#glos-main-module) хранить в [модуль кэш-памяти](https://go.dev/ref/mod#glos-module-cache) с тех пор не пересматривались они были загружены.

### `go mod why`

Использование:
```
go mod why [-m] [-vendor] packages...
```

`go mod why` на графике импорта показан кратчайший путь от основного модуля к каждому из перечисленных пакетов.

### `go version -m`

Использование:
```
go version [-m] [-v] [file ...]
```

`go version` сообщает версию Go, использованную для сборки каждого исполняемого файла с именем в командной строке.

### `go clean -modcache`

Использование:
```
go clean [-modcache]
```

`-modcache` Флаг вызывает [`go clean`](https://go.dev/cmd/go/#hdr-Remove_object_files_and_cached_files) удаление всего [кэша модуля](https://go.dev/ref/mod#glos-module-cache), включая распакованный исходный код версионных зависимостей .

